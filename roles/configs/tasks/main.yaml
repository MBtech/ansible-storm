---

- name: "Hosts file"
  lineinfile:   dest=/etc/hosts 
                regexp='.*{{ item }}$'
                line="{{ hostvars[item].ansible_default_ipv4.address }} {{item}}"
                state=present
  sudo: yes
  when: hostvars[item].ansible_default_ipv4.address is defined
  with_items: groups['all']

- name: "Install Daemon"
  apt: pkg=daemon state=present update_cache=yes
  sudo: yes

- name: "Install ifstat"
  apt: pkg=ifstat state=present
  sudo: yes

- name: "Install sysstat"
  apt: pkg=sysstat state=present
  sudo: yes

- name: "Install maven"
  apt: pkg=maven state=present
  sudo: yes

- name: "Install Java 7"
  apt: pkg=openjdk-7-jdk state=present
  sudo: yes

- name: "Installing perf"
  apt: pkg=linux-tools-common state=present
  sudo: yes

- name: "Get TDigest Service"
  git: repo=https://github.com/MBtech/TDigestService.git dest={{ base_path }}/TDigestService

- name: "Storm Benchmark"
  git: repo=https://github.com/MBtech/stormbenchmark.git dest={{ base_path }}/storm-benchmark

- name: "Get Redis"
  get_url: url=http://download.redis.io/releases/redis-3.2.3.tar.gz dest={{ base_path }}/redis-3.2.3.tar.gz

- name: Untar Redis
  unarchive: src={{ base_path }}/redis-3.2.3.tar.gz dest={{ base_path }}/redis copy=no creates={{ base_path }}/redis/redis-3.2.3

- name: make Redis
  make: chdir={{ base_path }}/redis/redis-3.2.3
